{"remainingRequest":"/Users/usuario/Desktop/SoftwareDEV/MisionTIC/mental-health-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/usuario/Desktop/SoftwareDEV/MisionTIC/mental-health-app/src/components/ContentFeed/components/Post.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/usuario/Desktop/SoftwareDEV/MisionTIC/mental-health-app/src/components/ContentFeed/components/Post.vue","mtime":1634286968575},{"path":"/Users/usuario/Desktop/SoftwareDEV/MisionTIC/mental-health-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/usuario/Desktop/SoftwareDEV/MisionTIC/mental-health-app/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/usuario/Desktop/SoftwareDEV/MisionTIC/mental-health-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/usuario/Desktop/SoftwareDEV/MisionTIC/mental-health-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldEZyb21Mb2NhbCB9IGZyb20gIkAvdXRpbHMvbG9jYWxTdG9yYWdlIjsKaW1wb3J0IHsgdXBkYXRlUG9zdCB9IGZyb20gIkAvc2VydmljZXMvcG9zdCI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUG9zdCIsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGl0ZW1zOiBbCiAgICAgICAgeyBpZDogMSwgbWVzc2FnZTogIkhlbGxvIGJybyEiIH0sCiAgICAgICAgeyBpZDogMiwgbWVzc2FnZTogIllldCBhbm90aGVyIGNvbW1lbnQiIH0sCiAgICAgIF0sCiAgICAgIHZvdGVkUG9zdDogZmFsc2UsCiAgICAgIGVkaXRhYmxlOiBmYWxzZSwKICAgICAgaXNDb21tZW50aW5nOiBmYWxzZSwKICAgICAgbmV3Q29tbWVudDogIiIsCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHVzZXJJZCgpIHsKICAgICAgY29uc3QgdXNlcklkID0gZ2V0RnJvbUxvY2FsKCJ1c2VyIikudXNlci5pZDsKICAgICAgcmV0dXJuIHVzZXJJZDsKICAgIH0sCiAgICB1c2VyKCkgewogICAgICByZXR1cm4gZ2V0RnJvbUxvY2FsKCJ1c2VyIik7CiAgICB9LAogICAgY3VycmVudFBvc3QoKSB7CiAgICAgIGNvbnN0IGN1cnJlbnRQb3N0ID0gdGhpcy4kc3RvcmUuc3RhdGUucG9zdHMuZmlsdGVyKChwb3N0KSA9PiB7CiAgICAgICAgcmV0dXJuIHBvc3QuaWQudHJpbSgpID09IHRoaXMuJHByb3BzLmRhdGEuaWQudHJpbSgpID8gcG9zdCA6IG51bGw7CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIGN1cnJlbnRQb3N0Lmxlbmd0aCAhPT0gMCA/IGN1cnJlbnRQb3N0WzBdIDogbnVsbDsKICAgIH0sCiAgfSwKCiAgcHJvcHM6IFsiZGF0YSJdLAogIGNyZWF0ZWQoKSB7CiAgICBjb25zdCBjYW5FZGl0UG9zdCA9IHRoaXMuZGV0ZXJtaW5lUG9zdE93bmVyc2hpcCgpOwogICAgaWYgKGNhbkVkaXRQb3N0KSB7CiAgICAgIC8vIHRoaXMuZWRpdGFibGUgPSB0cnVlOwogICAgfQogICAgY29uc3QgaGFzTGlrZWQgPSB0aGlzLiRwcm9wcy5kYXRhLmxpa2VzLmZpbmQoCiAgICAgICh1c2VySWQpID0+IHVzZXJJZCA9PSB0aGlzLnVzZXJJZAogICAgKTsKICAgIGlmIChoYXNMaWtlZCkgewogICAgICB0aGlzLnZvdGVkUG9zdCA9IHRydWU7CiAgICB9CiAgfSwKICBtb3VudGVkKCkge30sCiAgbWV0aG9kczogewogICAgdm90ZShpZCkgewogICAgICBpZiAoIXRoaXMudm90ZWRQb3N0KSB7CiAgICAgICAgdGhpcy52b3RlZFBvc3QgPSAhdGhpcy52b3RlZFBvc3Q7CiAgICAgICAgY29uc3QgbmV3TGlrZXNBcnJheSA9IHRoaXMuJHByb3BzLmRhdGEubGlrZXMuY29uY2F0KHRoaXMudXNlcklkKTsKICAgICAgICB1cGRhdGVQb3N0KHsKICAgICAgICAgIG5ld1Bvc3REYXRhOiB7IGxpa2VzOiBuZXdMaWtlc0FycmF5IH0sCiAgICAgICAgICBwb3N0SWQ6IHRoaXMuJHByb3BzLmRhdGEuaWQsCiAgICAgICAgfSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgidm90ZVBvc3QiLCB7IHVwZGF0ZWRQb3N0OiByZXMuZGF0YSB9KTsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdyZXMnLHJlcyk7CiAgICAgICAgICAvLyB0aGlzLiRzdG9yZS5kaXNwYXRjaCgidXBkYXRlUG9zdCIsIHJlcy5kYXRhKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBuZXdMaWtlc0FycmF5ID0gdGhpcy4kcHJvcHMuZGF0YS5saWtlcy5maWx0ZXIoCiAgICAgICAgICAobGlrZSkgPT4gbGlrZSAhPT0gdGhpcy51c2VySWQKICAgICAgICApOwogICAgICAgIHVwZGF0ZVBvc3QoewogICAgICAgICAgbmV3UG9zdERhdGE6IHsgbGlrZXM6IG5ld0xpa2VzQXJyYXkgfSwKICAgICAgICAgIHBvc3RJZDogdGhpcy4kcHJvcHMuZGF0YS5pZCwKICAgICAgICB9KS50aGVuKChyZXMpID0+IHsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdkb3dudm90ZWQgcG9zdCByZXN1bCcsIHJlcy5kYXRhKTsKICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJ1cGRhdGVQb3N0IiwgcmVzLmRhdGEpOwogICAgICAgICAgdGhpcy52b3RlZFBvc3QgPSBmYWxzZTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGVkaXRQb3N0KCkgewogICAgICBjb25zdCBjYW5FZGl0UG9zdCA9IHRoaXMuZGV0ZXJtaW5lUG9zdE93bmVyc2hpcCgpOwogICAgICBpZiAoY2FuRWRpdFBvc3QpIHsKICAgICAgICB0aGlzLmVkaXRhYmxlID0gIXRoaXMuZWRpdGFibGU7CiAgICAgIH0KICAgIH0sCiAgICB1cGRhdGVQb3N0KCkgewogICAgICBjb25zdCBuZXdQb3N0Q29udGVudCA9IHRoaXMuJHByb3BzLmRhdGEuY29udGVudC5yZXBsYWNlKCJcbiIsICIiKTsKICAgICAgdXBkYXRlUG9zdCh7CiAgICAgICAgbmV3UG9zdERhdGE6IHsgY29udGVudDogbmV3UG9zdENvbnRlbnQgfSwKICAgICAgICBwb3N0SWQ6IHRoaXMuJHByb3BzLmRhdGEuaWQsCiAgICAgIH0pLnRoZW4oKHJlcykgPT4gewogICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJ1cGRhdGVQb3N0IiwgcmVzLmRhdGEpOwogICAgICAgIHRoaXMuZWRpdGFibGUgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAogICAgZGV0ZXJtaW5lUG9zdE93bmVyc2hpcCgpIHsKICAgICAgY29uc3Qgb3duZXJzaGlwUmVzdWx0ID0KICAgICAgICB0aGlzLiRwcm9wcy5kYXRhLnVzZXIuaWQudHJpbSgpID09IHRoaXMudXNlcklkLnRyaW0oKSA/IHRydWUgOiBmYWxzZTsKICAgICAgcmV0dXJuIG93bmVyc2hpcFJlc3VsdDsKICAgIH0sCiAgICBoYXNWb3RlZFBvc3QoKSB7CiAgICAgIGNvbnN0IGhhc0xpa2VkID0gdGhpcy4kcHJvcHMuZGF0YS5saWtlcy5maW5kKAogICAgICAgICh1c2VySWQpID0+IHVzZXJJZCA9PSB0aGlzLnVzZXJJZAogICAgICApOwogICAgICByZXR1cm4gaGFzTGlrZWQgIT09IHVuZGVmaW5lZCA/IHRydWUgOiBmYWxzZTsKICAgIH0sCiAgICBuZXdDb21tZW50SGFuZGxlcigpIHsKICAgICAgdGhpcy5pc0NvbW1lbnRpbmcgPSAhdGhpcy5pc0NvbW1lbnRpbmc7CiAgICB9LAogICAgc2VuZENvbW1lbnRIYW5kbGVyKCkgewogICAgICB1cGRhdGVQb3N0KHsKICAgICAgICBuZXdQb3N0RGF0YTogewogICAgICAgICAgbmV3Q29tbWVudDogewogICAgICAgICAgICBjb21tZW50OiB0aGlzLm5ld0NvbW1lbnQsCiAgICAgICAgICAgIGF1dGhvcjogdGhpcy51c2VyLnVzZXIudXNlcm5hbWUsCiAgICAgICAgICB9LAogICAgICAgIH0sCiAgICAgICAgcG9zdElkOiB0aGlzLiRwcm9wcy5kYXRhLmlkLAogICAgICB9KS50aGVuKChyZXMpID0+IHsKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgidXBkYXRlUG9zdCIsIHJlcy5kYXRhKTsKICAgICAgfSk7CiAgICB9LAogICAgZm9ybWF0U3RyaW5nKHN0cmluZ0RhdGUpIHsKICAgICAgdmFyIG9wdGlvbnMgPSB7IHllYXI6ICJudW1lcmljIiwgbW9udGg6ICJzaG9ydCIsIGRheTogIm51bWVyaWMiIH07CiAgICAgIGxldCBwb3N0RGF0ZSA9IG5ldyBEYXRlKHN0cmluZ0RhdGUpOwogICAgICByZXR1cm4gcG9zdERhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCJlbi1VUyIsIG9wdGlvbnMpOwogICAgfSwKICAgIGdvVG9Qcm9maWxlSGFuZGxlcigpIHsKICAgICAgY29uc29sZS5sb2coInNlYXJjaGluZyBwcm9maWxlIik7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZTogYFByb2ZpbGVgLCBwYXJhbXM6e2lkOiBgJHt0aGlzLmN1cnJlbnRQb3N0LnVzZXIuaWR9YH0gfSk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["Post.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Post.vue","sourceRoot":"src/components/ContentFeed/components","sourcesContent":["<template>\n  <div class=\"wrapper\">\n    <div class=\"post-avatar\">\n      <div class=\"d-flex justify-content-center align-items-center\">\n        <span @click=\"goToProfileHandler\"><b-avatar text=\"BV\"></b-avatar></span>\n      </div>\n      <div class=\"info d-flex flex-column align-items-start\">\n        <p class=\"username m-0\">@{{ currentPost.user.username }}</p>\n\n        <p class=\"date font-weight-lighter\">\n          {{ formatString(currentPost.created_at) }}\n        </p>\n      </div>\n      <b-icon-three-dots @click=\"editPost()\" />\n    </div>\n    <div class=\"post-content pl-5\">\n      <p v-if=\"!editable\" class=\"comment-txt\">\n        {{ currentPost.content }}\n      </p>\n      <textarea\n        v-else\n        v-model=\"currentPost.content\"\n        v-on:keyup.enter=\"updatePost()\"\n      ></textarea>\n      <div class=\"action-icons\">\n        <div>\n          1\n          <b-icon-chat @click=\"newCommentHandler\" />\n        </div>\n        <div class=\"d-flex ml-2\">\n          {{ currentPost.likes.length }}\n          <div class=\"ml-1\" v-bind:class=\"[votedPost ? 'voted' : 'not-voted']\">\n            <b-icon-suit-heart-fill @click=\"vote(currentPost.id)\" />\n          </div>\n        </div>\n      </div>\n      <div v-if=\"isCommenting\">\n        <div class=\"form-group\">\n          <input\n            class=\"form-control form-control-sm\"\n            type=\"text\"\n            placeholder=\"new comment..\"\n            v-model=\"newComment\"\n          />\n        </div>\n        <div class=\"d-flex flex-column justify-content-end align-items-end\">\n          <div class=\"comment-post-action-wrapper d-flex flex-row\">\n            <b-button\n              size=\"sm\"\n              pill\n              variant=\"primary\"\n              class=\"mr-2\"\n              @click=\"sendCommentHandler\"\n              >Send</b-button\n            >\n            <b-button\n              size=\"sm\"\n              pill\n              variant=\"outline-danger\"\n              @click=\"newCommentHandler\"\n              >X</b-button\n            >\n          </div>\n        </div>\n      </div>\n    </div>\n    <div\n      class=\"post-comments\"\n      v-for=\"comment in currentPost.comments\"\n      :key=\"comment.id\"\n    >\n      <b-avatar class=\"icon\"></b-avatar>\n      <div class=\"comment\">\n        <p class=\"\">@{{ comment.author }}</p>\n        <p class=\"comment-txt\">{{ comment.content }}</p>\n      </div>\n    </div>\n\n    <div class=\"overflow-auto\"></div>\n  </div>\n</template>\n\n<script>\nimport { getFromLocal } from \"@/utils/localStorage\";\nimport { updatePost } from \"@/services/post\";\nexport default {\n  name: \"Post\",\n  data() {\n    return {\n      items: [\n        { id: 1, message: \"Hello bro!\" },\n        { id: 2, message: \"Yet another comment\" },\n      ],\n      votedPost: false,\n      editable: false,\n      isCommenting: false,\n      newComment: \"\",\n    };\n  },\n  computed: {\n    userId() {\n      const userId = getFromLocal(\"user\").user.id;\n      return userId;\n    },\n    user() {\n      return getFromLocal(\"user\");\n    },\n    currentPost() {\n      const currentPost = this.$store.state.posts.filter((post) => {\n        return post.id.trim() == this.$props.data.id.trim() ? post : null;\n      });\n\n      return currentPost.length !== 0 ? currentPost[0] : null;\n    },\n  },\n\n  props: [\"data\"],\n  created() {\n    const canEditPost = this.determinePostOwnership();\n    if (canEditPost) {\n      // this.editable = true;\n    }\n    const hasLiked = this.$props.data.likes.find(\n      (userId) => userId == this.userId\n    );\n    if (hasLiked) {\n      this.votedPost = true;\n    }\n  },\n  mounted() {},\n  methods: {\n    vote(id) {\n      if (!this.votedPost) {\n        this.votedPost = !this.votedPost;\n        const newLikesArray = this.$props.data.likes.concat(this.userId);\n        updatePost({\n          newPostData: { likes: newLikesArray },\n          postId: this.$props.data.id,\n        }).then((res) => {\n          this.$store.dispatch(\"votePost\", { updatedPost: res.data });\n          // console.log('res',res);\n          // this.$store.dispatch(\"updatePost\", res.data);\n        });\n      } else {\n        const newLikesArray = this.$props.data.likes.filter(\n          (like) => like !== this.userId\n        );\n        updatePost({\n          newPostData: { likes: newLikesArray },\n          postId: this.$props.data.id,\n        }).then((res) => {\n          // console.log('downvoted post resul', res.data);\n          this.$store.dispatch(\"updatePost\", res.data);\n          this.votedPost = false;\n        });\n      }\n    },\n    editPost() {\n      const canEditPost = this.determinePostOwnership();\n      if (canEditPost) {\n        this.editable = !this.editable;\n      }\n    },\n    updatePost() {\n      const newPostContent = this.$props.data.content.replace(\"\\n\", \"\");\n      updatePost({\n        newPostData: { content: newPostContent },\n        postId: this.$props.data.id,\n      }).then((res) => {\n        this.$store.dispatch(\"updatePost\", res.data);\n        this.editable = false;\n      });\n    },\n    determinePostOwnership() {\n      const ownershipResult =\n        this.$props.data.user.id.trim() == this.userId.trim() ? true : false;\n      return ownershipResult;\n    },\n    hasVotedPost() {\n      const hasLiked = this.$props.data.likes.find(\n        (userId) => userId == this.userId\n      );\n      return hasLiked !== undefined ? true : false;\n    },\n    newCommentHandler() {\n      this.isCommenting = !this.isCommenting;\n    },\n    sendCommentHandler() {\n      updatePost({\n        newPostData: {\n          newComment: {\n            comment: this.newComment,\n            author: this.user.user.username,\n          },\n        },\n        postId: this.$props.data.id,\n      }).then((res) => {\n        this.$store.dispatch(\"updatePost\", res.data);\n      });\n    },\n    formatString(stringDate) {\n      var options = { year: \"numeric\", month: \"short\", day: \"numeric\" };\n      let postDate = new Date(stringDate);\n      return postDate.toLocaleDateString(\"en-US\", options);\n    },\n    goToProfileHandler() {\n      console.log(\"searching profile\");\n      this.$router.push({ name: `Profile`, params:{id: `${this.currentPost.user.id}`} });\n    },\n  },\n};\n</script>\n\n<style scoped>\n.wrapper {\n  display: flex;\n  flex-direction: column;\n  /* background-color: #e7f5ff; */\n  /* background-color: #dff9fd ; */\n  padding: 0.5rem;\n  border-radius: 0.5rem;\n  margin-bottom: 2rem;\n}\n\n.wrapper .post-avatar {\n  display: flex;\n  gap: 1rem;\n}\n\n.info .date {\n  font-size: 0.8rem;\n}\n.wrapper .post-content {\n  margin: 0.5rem 0.5rem;\n  width: 90%;\n}\n.action-icons {\n  margin-top: 0.5rem;\n  text-align: center;\n  display: flex;\n  justify-content: center;\n}\n.action-icons :first-child {\n  margin-right: 0.2rem;\n}\n.post-comments {\n  display: flex;\n  margin-left: 1rem;\n  margin-top: 1rem;\n}\n.comment {\n  flex: 1;\n  border: 1px solid #ede9e9;\n  display: table-cell;\n  margin-left: 20px;\n  margin-right: 1rem;\n  padding: 10px;\n  vertical-align: top;\n  position: relative;\n  width: 65%;\n}\n.username {\n  font-weight: bold;\n}\n.comment-txt {\n  font-size: 0.9rem;\n  color: #575757;\n}\n.comment::before {\n  border-bottom: 10px solid transparent;\n  border-right: 11px solid #ede9e9;\n  border-top: 10px solid transparent;\n  left: -11px;\n  top: 10px;\n  position: absolute;\n  content: \"\";\n}\n.comment::after {\n  border-bottom: 8px solid transparent;\n  border-right: 9px solid #fff;\n  border-top: 8px solid transparent;\n  left: -9px;\n  top: 12px;\n  position: absolute;\n  content: \"\";\n}\n.post-comments > .comment {\n  color: #707070;\n}\n\n/* icons */\n.bi-suit-heart-fill > * {\n  cursor: pointer;\n  transition: all 2s;\n  font-size: 1rem;\n  /* color: rgb(146, 10, 10); */\n}\n.not-voted {\n  color: rgb(206, 206, 206) !important;\n}\n.voted {\n  color: rgb(201, 69, 69);\n}\n.bi-suit-heart-fill:hover {\n  transition: all 1s;\n  font-size: 1.5rem;\n}\n\n/* Edit Post Icon */\n.bi-three-dots {\n  cursor: pointer;\n}\n\n.comment-post-action-wrapper {\n  /* width: 20%; */\n}\n</style>\n"]}]}